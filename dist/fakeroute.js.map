{"version":3,"sources":["fakeroute.es6"],"names":[],"mappings":"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","file":"fakeroute.js","sourcesContent":["/*jshint esversion:6*/\r\nvar fakeRoute= function(){};\r\nfakeRoute.options={\r\n    selector:'a',\r\n    target:'body',\r\n    equalStyle:[],\r\n    enableSrcScripts:true,//add \"data-fakeroute-script\" attr to script tag\r\n    enableInlineScripts:true,//add \"data-fakeroute-script\" attr to script tag\r\n    enableStyleSheets:true,\r\n    enableInlineStyles:true\r\n};\r\n\r\nfakeRoute.onLoading=null;\r\nfakeRoute.onLoad=null;//onload\r\nfakeRoute.onUnload=null;\r\nfakeRoute.onError=null;\r\n\r\nfakeRoute.state = {\r\n    _wait : false,\r\n    _callback : null,\r\n    _callbackParam : null,\r\n    wait:function () {\r\n        fakeRoute.state._wait=true;\r\n    },\r\n    resolve :  function() {\r\n        if (fakeRoute.state._callback) fakeRoute.state._callback.call(...fakeRoute.state._callbackParam);\r\n        fakeRoute.state._wait=false;\r\n        fakeRoute.state._callback=null;\r\n        fakeRoute.state._callbackParam=null;\r\n\r\n    },\r\n    set:function (callb,param) {\r\n        fakeRoute.state._callback=callb;\r\n        fakeRoute.state._callbackParam=param;\r\n        if (!fakeRoute.state._wait) fakeRoute.state.resolve();\r\n    }\r\n};\r\n\r\n\r\nfakeRoute.datas={\r\n    pages:[\r\n        // {id:1,url:'',title:'',data:''}\r\n    ],\r\n    ajaxObject:null\r\n};\r\nfakeRoute.init = function({selector,target}={}){\r\n    for (var item in arguments[0]) {\r\n        fakeRoute.options[item] = arguments[0][item];\r\n    }\r\n    document.body.addEventListener('click', function(e){\r\n        e.preventDefault();\r\n        let node = e.target;\r\n        do {\r\n            if( (node.matches || node.msMatchesSelector || node.webkitMatchesSelector).call(node, fakeRoute.options.selector)){\r\n                fakeRoute._detech(node);\r\n                break;\r\n            }\r\n        } while (node = node.parentElement);\r\n    });\r\n    window.onpopstate= function (e) {\r\n        let pageData;\r\n        for (var i = 0; i < fakeRoute.datas.pages.length; i++) {\r\n            let page= fakeRoute.datas.pages;\r\n            if (fakeRoute.datas.pages[i].id == e.state) {\r\n                pageData =fakeRoute.datas.pages[i];\r\n            }\r\n        }\r\n        if (pageData) {\r\n            fakeRoute.open(pageData.url,fakeRoute.options.target,false);\r\n        }else {\r\n            console.log('bulamadÄ±');\r\n        }\r\n    };\r\n    fakeRoute._loadPage(window.location.pathname,null,false,false);\r\n    window.history.replaceState(1,document.title,window.location.href);\r\n};\r\nfakeRoute._detech=function (elm) {\r\n    let target = elm.getAttribute('data-fakeroute-target') || fakeRoute.options.target;\r\n    let url = elm.getAttribute('data-fakeroute-url') || elm.getAttribute('href');\r\n    let hash = elm.getAttribute('data-fakeroute-hash') === 'false' ? false : true;\r\n    let force = elm.getAttribute('data-fakeroute-force') === 'true' ? true : false;\r\n    if (url) {\r\n        fakeRoute.open(url, target, hash, force);\r\n    }\r\n};\r\n\r\nfakeRoute.open = function (url, target= fakeRoute.options.target, hash=true, force=false) {\r\n    if(fakeRoute.onLoading) fakeRoute.onLoading.call(document.querySelector(target),fakeRoute.state);\r\n\r\n    fakeRoute._loadPage(url,function (pageData,hash,force) {\r\n        if (hash){\r\n            fakeRoute.addHash(pageData);\r\n        }\r\n\r\n        fakeRoute._pageInsertData(pageData,target);\r\n        fakeRoute._pageEqualStyle(pageData);\r\n        fakeRoute._pageUpdateMeta(pageData);\r\n\r\n\r\n    }, hash, force);\r\n};\r\n\r\n\r\nfakeRoute._pageInsertData=function (pageData, target){\r\n    let draft=document.createElement('div');\r\n    draft.innerHTML= pageData.data;\r\n\r\n    let wrap= document.createElement('div');\r\n    wrap.className=\"fakeroute-wrapper\";\r\n    let htmlContent= draft.querySelector(target).innerHTML;\r\n\r\n    let scripts= draft.querySelectorAll('script[data-fakeroute-script]:not([src])');\r\n    htmlContent = htmlContent.replace(/<script[^>]*>[^<]((.|\\n)*?)<\\/script>/g,'');\r\n\r\n    let styles= draft.querySelectorAll('style');\r\n    htmlContent = htmlContent.replace(/<style[^>]*>[^<]((.|\\n)*?)<\\/style>/g,'');\r\n\r\n    wrap.innerHTML=htmlContent;\r\n    if(fakeRoute.onUnload) fakeRoute.onUnload.call(document.querySelector(target));\r\n    document.querySelector(target).innerHTML=\"\";\r\n    document.querySelector(target).appendChild(wrap);\r\n    if(fakeRoute.onLoad)fakeRoute.onLoad.call(document.querySelector(target));\r\n\r\n    // exec inline script codes\r\n    if (fakeRoute.options.enableInlineScripts) {\r\n        for (let i = 0; i < scripts.length; i++) {\r\n            if(scripts[i]){\r\n                eval(scripts[i].innerText);\r\n            }\r\n        }\r\n    }\r\n\r\n    // insert inline stylesheets\r\n    if (fakeRoute.options.enableInlineStyles) {\r\n        for (let i = 0; i < styles.length; i++) {\r\n            if(styles[i]){\r\n                document.body.innerHTML +=styles[i].outerHTML;\r\n            }\r\n        }\r\n    }\r\n\r\n};\r\n\r\nfakeRoute._pageUpdateMeta=function (pageData){\r\n    let draft=document.createElement('div');\r\n    draft.innerHTML= pageData.data;\r\n    if (fakeRoute.options.enableSrcScripts) {\r\n    let scripts= draft.querySelectorAll('script[src][data-fakeroute-script]');\r\n    for (var i = 0; i < scripts.length; i++) {\r\n        if(scripts[i]){\r\n            let script = document.createElement('script');\r\n            script.setAttribute('src',scripts[i].getAttribute('src'));\r\n            if (scripts[i].getAttribute('type')) script.setAttribute('type',scripts[i].getAttribute('type'));\r\n            let oldScript =document.querySelector(`script[src='${script.getAttribute('src')}']`);\r\n            if (oldScript) oldScript.parentNode.removeChild(oldScript);\r\n            document.head.appendChild(script);\r\n        }\r\n    }\r\n}\r\n\r\n    document.title=pageData.title;\r\n};\r\n\r\nfakeRoute._pageEqualStyle=function (pageData){\r\n    let draft=document.createElement('div');\r\n    draft.innerHTML= pageData.data;\r\n\r\n    if (fakeRoute.options.enableStyleSheets) {\r\n        let stylesheets= document.querySelectorAll(`link[rel='stylesheet']`);\r\n        for (let i = 0; i < stylesheets.length; i++) {\r\n            stylesheets[i].parentNode.removeChild(stylesheets[i]);\r\n        }\r\n\r\n        let newStylesheets= draft.querySelectorAll(`link[rel='stylesheet']`);\r\n        for (let i = 0; i < newStylesheets.length; i++) {\r\n            let link = document.createElement('link');\r\n            link.setAttribute('rel','stylesheet');\r\n            if(newStylesheets[i].getAttribute('href')) link.setAttribute('href',newStylesheets[i].getAttribute('href'));\r\n            if(newStylesheets[i].getAttribute('media')) link.setAttribute('media',newStylesheets[i].getAttribute('media'));\r\n            if(newStylesheets[i].getAttribute('title')) link.setAttribute('title',newStylesheets[i].getAttribute('title'));\r\n            if(newStylesheets[i].getAttribute('charset')) link.setAttribute('charset',newStylesheets[i].getAttribute('charset'));\r\n            document.head.appendChild(link);\r\n        }\r\n    }\r\n\r\n    fakeRoute.options.equalStyle.forEach(function (sel) {\r\n        let effectingDiv=document.querySelector(sel);\r\n        let effectorDiv=draft.querySelector(sel);\r\n        if (effectingDiv && effectorDiv){\r\n            effectingDiv.className = effectorDiv.className;\r\n            effectingDiv.setAttribute('style',effectorDiv.getAttribute('style'));\r\n        }\r\n    });\r\n};\r\n\r\n\r\n\r\nfakeRoute._loadPage=function(url,callback, hash=true, force=false) {\r\n    for (var i = 0; i < fakeRoute.datas.pages.length; i++) {\r\n        let page = fakeRoute.datas.pages[i];\r\n        if (page.url === url){\r\n            if (!force){\r\n                if(callback) fakeRoute.state.set(callback,[this,page,hash,force]);\r\n                return;\r\n            }else {\r\n                fakeRoute.datas.pages.splice(i,1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    var req = new XMLHttpRequest();\r\n    req.open('GET',url);\r\n    req.addEventListener(\"load\", function (e) {\r\n        let draft=document.createElement('div');\r\n        draft.innerHTML= this.responseText;\r\n        let pageTitle = draft.querySelector('title') ? draft.querySelector('title').innerText : 'Untitled';\r\n        let newId =fakeRoute.datas.pages.reduce( (a,b)=> b.id >a ? b.id : a ,0) + 1;\r\n        fakeRoute.datas.pages.push({id:newId,url:url,title:pageTitle,data:this.responseText});\r\n        if(callback) fakeRoute.state.set(callback,[this,fakeRoute.datas.pages[fakeRoute.datas.pages.length-1], hash, force]);\r\n        return ;\r\n    });\r\n    req.addEventListener(\"error\", function (e) {\r\n        if (fakeRoute.onError) fakeRoute.onError.call(e);\r\n    });\r\n    setTimeout(function () {\r\n        req.send();\r\n    },300);\r\n};\r\n\r\nfakeRoute.addHash=function ({id, url, title}) {\r\n    window.history.pushState(id,title,url);\r\n};\r\n"],"sourceRoot":"/source/"}