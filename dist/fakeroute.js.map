{"version":3,"sources":["fakeroute.es6"],"names":[],"mappings":"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","file":"fakeroute.js","sourcesContent":["/*jshint esversion:6*/\r\nvar fakeRoute= function(){};\r\nfakeRoute.options={\r\n    selector:'a',\r\n    target:'body',\r\n    equalStyle:'',\r\n};\r\n\r\nfakeRoute.onLoading=null;\r\nfakeRoute.onLoad=null;//onload\r\nfakeRoute.onUnload=null;\r\nfakeRoute.onError=null;\r\n\r\nfakeRoute.state = {\r\n    _wait : false,\r\n    _callback : null,\r\n    _callbackParam : null,\r\n    wait:function () {\r\n        fakeRoute.state._wait=true;\r\n    },\r\n    resolve :  function() {\r\n        if (fakeRoute.state._callback) fakeRoute.state._callback.call(...fakeRoute.state._callbackParam);\r\n        fakeRoute.state._wait=false;\r\n        fakeRoute.state._callback=null;\r\n        fakeRoute.state._callbackParam=null;\r\n\r\n    },\r\n    set:function (callb,param) {\r\n        fakeRoute.state._callback=callb;\r\n        fakeRoute.state._callbackParam=param;\r\n        if (!fakeRoute.state._wait) fakeRoute.state.resolve();\r\n    }\r\n};\r\n\r\n\r\nfakeRoute.datas={\r\n    pages:[\r\n        // {id:1,url:'',title:'',data:''}\r\n    ],\r\n    ajaxObject:null\r\n};\r\nfakeRoute.init = function({selector,target}={}){\r\n    for (var item in arguments[0]) {\r\n        fakeRoute.options[item] = arguments[0][item];\r\n    }\r\n    document.body.addEventListener('click', function(e){\r\n        e.preventDefault();\r\n        let node = e.target;\r\n        do {\r\n            if( (node.matches || node.msMatchesSelector || node.webkitMatchesSelector).call(node, fakeRoute.options.selector)){\r\n                fakeRoute._detech(node);\r\n                break;\r\n            }\r\n        } while (node = node.parentElement);\r\n    });\r\n    window.onpopstate= function (e) {\r\n        let pageData;\r\n        for (var i = 0; i < fakeRoute.datas.pages.length; i++) {\r\n            let page= fakeRoute.datas.pages;\r\n            if (fakeRoute.datas.pages[i].id == e.state) {\r\n                pageData =fakeRoute.datas.pages[i];\r\n            }\r\n        }\r\n        if (pageData) {\r\n            fakeRoute.open(pageData.url,fakeRoute.options.target,false);\r\n        }else {\r\n            console.log('bulamadÄ±');\r\n        }\r\n    };\r\n    fakeRoute._loadPage(window.location.pathname,null,false,false);\r\n    window.history.replaceState(1,document.title,window.location.href);\r\n};\r\nfakeRoute._detech=function (elm) {\r\n    let target = elm.getAttribute('data-fakeroute-target') || fakeRoute.options.target;\r\n    let url = elm.getAttribute('data-fakeroute-url') || elm.getAttribute('href');\r\n    let hash = elm.getAttribute('data-fakeroute-hash') === 'false' ? false : true;\r\n    let force = elm.getAttribute('data-fakeroute-force') === 'true' ? true : false;\r\n    if (url) {\r\n        fakeRoute.open(url, target, hash, force);\r\n    }\r\n};\r\n\r\nfakeRoute.open = function (url, target= fakeRoute.options.target, hash=true, force=false) {\r\n    if(fakeRoute.onLoading) fakeRoute.onLoading.call(document.querySelector(target),fakeRoute.state);\r\n    fakeRoute._loadPage(url,function (pageData,hash,force) {\r\n        if (hash){\r\n            fakeRoute.addHash(pageData);\r\n        }\r\n        let draft=document.createElement('div');\r\n        draft.innerHTML= pageData.data;\r\n        let wrap= document.createElement('div');\r\n        wrap.className=\"fakeroute-wrapper\";\r\n        wrap.innerHTML= draft.querySelector(target).innerHTML;\r\n        document.title=pageData.title;\r\n        document.querySelector(target).innerHTML=\"\";\r\n        if(fakeRoute.onUnload) fakeRoute.onUnload.call(document.querySelector(target));\r\n        document.querySelector(target).appendChild(wrap);\r\n        fakeRoute.options.equalStyle.split(',').forEach(function (sel) {\r\n            let effectingDiv=document.querySelector(sel);\r\n            let effectorDiv=draft.querySelector(sel);\r\n            if (effectingDiv && effectorDiv){\r\n                effectingDiv.className = effectorDiv.className;\r\n                effectingDiv.setAttribute('style',effectorDiv.getAttribute('style'));\r\n            }\r\n        });\r\n\r\n        if(fakeRoute.onLoad)fakeRoute.onLoad.call(document.querySelector(target));\r\n\r\n\r\n    }, hash, force);\r\n};\r\n\r\nfakeRoute._loadPage=function(url,callback, hash=true, force=false) {\r\n    for (var i = 0; i < fakeRoute.datas.pages.length; i++) {\r\n        let page = fakeRoute.datas.pages[i];\r\n        if (page.url === url){\r\n            if (!force){\r\n                if(callback) fakeRoute.state.set(callback,[this,page,hash,force]);\r\n                return;\r\n            }else {\r\n                fakeRoute.datas.pages.splice(i,1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    var req = new XMLHttpRequest();\r\n    req.open('GET',url);\r\n    req.addEventListener(\"load\", function (e) {\r\n        let draft=document.createElement('div');\r\n        draft.innerHTML= this.responseText;\r\n        let pageTitle = draft.querySelector('title') ? draft.querySelector('title').innerText : 'Untitled';\r\n        let newId =fakeRoute.datas.pages.reduce( (a,b)=> b.id >a ? b.id : a ,0) + 1;\r\n        fakeRoute.datas.pages.push({id:newId,url:url,title:pageTitle,data:this.responseText});\r\n        if(callback) fakeRoute.state.set(callback,[this,fakeRoute.datas.pages[fakeRoute.datas.pages.length-1], hash, force]);\r\n        return ;\r\n    });\r\n    req.addEventListener(\"error\", function (e) {\r\n        if (fakeRoute.onError) fakeRoute.onError.call(e);\r\n    });\r\n    setTimeout(function () {\r\n        req.send();\r\n    },300);\r\n};\r\n\r\nfakeRoute.addHash=function ({id, url, title}) {\r\n    window.history.pushState(id,title,url);\r\n};\r\n"],"sourceRoot":"/source/"}